<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, video, noodp, noarchive, noimageindex" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I love Remilia</title>
    <link rel="Icons/apple-touch-icon" sizes="180x180" href="Icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="Icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="Icons/favicon-16x16.png">
    <link rel="manifest" href="Icons/site.webmanifest">
<style>
    nav a:not(:last-child)::after {
        content: '|';
        background-color: white; 
        margin: 0 1.7vw; 
    }  
    nav a:hover {
        text-decoration: underline;
    }
    .oldtopnav {
        overflow: hidden;
        background-color: #333;
    }
    .oldtopnav a {
        float: left;
        color: #f2f2f2;
        text-align: left;
        padding: 0.911vw 0;
        margin-left: 1.45vw;
        text-decoration: none;
        font-size: 0.911vw;
        white-space: nowrap; /* Prevent text wrapping */  
    }
    .newtopnav {
        overflow: hidden;
        background-color: #333;
    }
    .newtopnav a {
        float: left;
        color: #f2f2f2;
        text-align: left;
        padding: 0.911vw 0;
        margin-left: 1.6vw;
        text-decoration: none;
        font-size: 0.911vw;
        white-space: nowrap; /* Prevent text wrapping */  
    }
    body {
        background-image: url("Other_Files/bg-tv.png");
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: 100% 100%;
        margin:0 /* Make topnav spread fullscreen */
    }
    h1 {
        font: Joane-Regular;
        color: black; 
        font-size: 1.979vw;
        text-align:center;
    }
    .emilia {
        position:absolute;
        width: 28vw;
        height: 28vw;
        left: 75vw;
        top: 12vw
    }
    .subaru {
        position:absolute;
        bottom:0;
        left:38vw;
        width: 24vw;
        height: 9.45vw;
        pointer-events: auto;
        user-select: none;
    }
    h3 {
        position:absolute;
        left: 0.5vw;
        bottom: -0.6vw;
        font-size:0.8vw;
    }
    p {
        font-family:'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
        text-align: center;
        font-size: 1.146vw;
        font-weight: bold;  
        margin-top:2.5vw
    }
    #videoPlayer {
        max-width: 100%;
        margin: 0 auto;
        margin-top: 0.5vw;
        display: block;
    }
    nav a {
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold
    }
    .moveable_img{
        position: relative;
        top: 3vw;
        left: 1vw;
        width: 15vw;
        height: 6.3vw;
        margin-top: -4vw;
        cursor: pointer;
    }
    .button-container {
        text-align: center;
        position: relative;
        top: 0.25vw;
    }
    .loop{
        vertical-align:top;
        position: relative;
        left: 0.22vw;
    }
    .loopicon { 
        top: 0.2vw;
        width:0.7vw;
        height:0.7vw;
    }
    .randomizeicon{
        position:relative;
        right: 0.5vw;
        width:0.7vw;
        height:0.7vw;
    }
    .delayicon { 
        position: relative;
        left: 0.2vw;
        width:0.5vw;
        height:0.5vw;
    }
    #changeDelayButton {
        vertical-align:top;
        position: relative;
        left: 0.5vw;
        width: auto;
        height: auto;
    }
    @media only screen and (max-width:1990px) {
        .emilia {
            display:none;
        }
    }
    @media only screen and (max-width: 722px) {
        body {
            background-image: url(Other_Files/bg-tv.png);
        }
        .subaru {
            width: 60vw;
            height: 23.62vw;
            left: 25vw;
        }
        h3 {
            font-size:1.1vw;
        }   
        .moveable_img {
            position: relative;
            top: 7.5vw;
            left: 2.5vw;
            width: 37.5vw;
            height: 15vw;
            margin-top: -9vw;
        }  
        h1 {
            font-size: 5vw; /* Adjust the font size of h1 for mobile */
            margin-top:3vw;
        }
        p {
            font-size: 2.8vw; /* Adjust the font size of p for mobile */
            margin-top:4vw;
        }
         #videoPlayer {
            max-width: 100%; /* Make the video player responsive */
            height: auto; /* Allow the video player to adjust its height */
            margin-top: 4vw;
        }
        .topnav a {
            font-size:2.2vw;
            margin-left: 1.73vw;
            text-align: left;
            padding: 2vw 0;
        } 
        .topnav {
            margin-top:5vw;
        }
        .button-container{
            position: absolute;
            top: 72vh;
            left: 23vw;
        }
        #shuffleButton{
            font-size: 2.4vw;
            vertical-align:top;
            width: 20vw;
            height: 12vw;  
        }
        .loop{
            vertical-align:top;
            width: 20.5vw;
            height: 12vw;          
        }
        .looptext {
            font-size: 2.3vw;
        }
        #changeDelayButton{
            vertical-align : top; 
            font-size: 2.45vw;
            width: 20vw;
            height: 12vw;
        }
        .loopicon {
            position: relative;
            width:2vw;
            height:2vw;
            top:0.3vw;
        }
        .randomizeicon {
            position: relative;
            width:2vw;
            height:2vw;
            top:0.3vw;
        }
        .delayicon {
            position: relative;
            width:2vw;
            height:2vw;
            top:0.6vw;
        }
        @media screen and (orientation: landscape) {
             body {
                 display: none; /* Hide content in landscape mode */     }
        }
    }
</style>
    <link href = "Other_Files/stylesheet.css" rel = "stylesheet" type = "text/css" />
</head>
<body>
    <h1>
        <img class= "moveable_img" src="Other_Files/Re_ZERO icon (1).png"  alt="Re:ZERO icon">
        <span  id="text_to_change"> All OPs and EDs </span>
    </h1>
    <p>
        My first project - Feel free to enjoy the Re:ZERO <span id="bodytext">Openings and Endings!</span> <br>
        (Click on the logo to change to <span id="songname">Insert Songs</span>)
    </p>
    <div class="oldtopnav">
        <nav id = "oldnavbarContent">
            <a href="#" onclick="playVideo('Openings_and_Endings/OP1 - Redo.mp4')">OP1 - Redo</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/ED1 - STYX HELIX.mp4')">ED1 - STYX HELIX</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/OP2 - Paradisus - Paradoxum.mp4')">OP2 - Paradisus - Paradoxum</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/ED2 - Stay Alive.mp4')">ED2 - Stay Alive</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/OP3 - Realize.mp4')">OP3 - Realize</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/ED3 - Memento.mp4')">ED3 - Memento</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/OP4 - Long shot.mp4')">OP4 - Long shot</a>
            <a href="#" onclick="playVideo('Openings_and_Endings/ED4 - Believe in you.mp4')">ED4 - Believe in you</a>
        </nav>
    </div>
    <div class ="newtopnav">
        <nav id = "newnavbarContent" style ="display: none;">
            <a href="#" onclick="playVideo('Insert_Songs/STRAIGHT BET.mp4')">EP 8 - STRAIGHT BET</a>
            <a href="#" onclick="playVideo('Insert_Songs/Memories.mp4')">OVA 1 - "Memories"</a>
            <a href="#" onclick="playVideo('Insert_Songs/White White Snow.mp4')">OVA 1 - "White White Snow"</a>
            <a href="#" onclick="playVideo('Insert_Songs/Yuki no hate ni Kimi no na wo.mp4')">OVA 2 - "Your Name"</a>
            <a href="#" onclick="playVideo('Insert_Songs/Wishing.mp4')">EP 18 - Wishing</a>
            <a href="#" onclick="playVideo('Insert_Songs/Door.mp4')">EP 40 - Door</a>
            <a href="#" onclick="playVideo('Insert_Songs/What you dont know.mp4')">EP 48 - What you don't know</a>
        </nav>
    </div>
    <div class="button-container">
        <button id = "shuffleButton">&nbsp&nbspRandomize&nbsp&nbsp&nbsp;
            <img class ="randomizeicon" src="Other_Files/randomize.jpg" alt="randomize icon">
        </button>
        <button class = "loop"><span class ="looptext">Enable looping&nbsp;</span>
            <img class ="loopicon" src="Other_Files/loop.png" alt="loop icon">
        </button>
        <button id="changeDelayButton">Change Delay
            <img class ="delayicon" src="Other_Files/delay.jpg" alt="delay icon">
        </button>
        
    </div>   
    <video id="videoPlayer" width="640" height="360"  poster="Other_Files/Beatrice_Anime (2).webp" controls preload="auto" playsinline onended="playNextVideo()">
        <source src="Openings_and_Endings/OP1 - Redo.mp4" type="video/mp4">
    </video>
    <h2><img class= "subaru" src="Other_Files/subaru cheering.png" alt="rezero cast in isekai quartet"> </h2>
    <h3 class="trademark">©2024 "TypingWithBeako" - Nguyễn Thái Tuấn <br>
         For audio version, you can visit <a href="https://open.spotify.com/playlist/2CIlJuP1CU7HpWLGX9T5DW" target="_blank">here</a>  
     </h3>
    <a href="https://myfigurecollection.net/item/713029" target="_blank">
        <img class ="emilia" src="Other_Files/emilia.png" alt="Emilia">
    </a>
</div>
<script>
    console.log ("To disable preloading, you can click the image below the video player. To re-enable preloading, you can click my trademark text")
    console.log("Currently, there is a bug relating to clicking the play button when the video ends. You can manually fix it by changing the delay to 0 milliseconds.")
    console.log("Video player keyboard controls: Spacebar: Play/Pause video; ArrowKeyRight: Skipping to next video; ArrowKeyRight: Returning to previous video")
    var videoUrls = [
        "Openings_and_Endings/OP1 - Redo.mp4",
        "Openings_and_Endings/ED1 - STYX HELIX.mp4",
        "Openings_and_Endings/OP2 - Paradisus - Paradoxum.mp4",
        "Openings_and_Endings/ED2 - Stay Alive.mp4",
        "Openings_and_Endings/OP3 - Realize.mp4",
        "Openings_and_Endings/ED3 - Memento.mp4",
        "Openings_and_Endings/OP4 - Long shot.mp4",
        "Openings_and_Endings/ED4 - Believe in you.mp4" 
    ];
    var newvideoUrls = [
        "Insert_Songs/STRAIGHT BET.mp4",
        "Insert_Songs/Memories.mp4",
        "Insert_Songs/White White Snow.mp4",
        "Insert_Songs/Yuki no hate ni Kimi no na wo.mp4",
        "Insert_Songs/Wishing.mp4",
        "Insert_Songs/Door.mp4",
        "Insert_Songs/What you dont know.mp4",
    ];
    
    let isPosterSet = false; //Track if poster is set
    let currentIndex = 0; // For videoUrls
    let newcurrentIndex =0; // For newvideoUrls
    let isSwitching = false;
    let clickCount = 0;
    let preloadedVideos = [];
    let disablePreloading = false;
    let nextVideoTimeout;
    let loopcurrentIndex = 0;
    let loopclickCount = 0;
    let enableLoopingListener = null;
    let delay = 2500;

    function playVideo(videoName) {
    // Update the video player screen with the selected video
    // For example, you can set the video source and play the video
        document.getElementById('videoPlayer').src = videoName;
        document.getElementById('videoPlayer').play();
        console.log('Video selected:',videoName)
        // Update the currentIndex and newcurrentIndex based on the selected video
        currentIndex = videoUrls.indexOf(videoName);
        newcurrentIndex = newvideoUrls.indexOf(videoName);
        if (!isPosterSet) {
            videoPlayer.poster = "Other_Files/black.png";
            isPosterSet = true;
        }
        // Clear the timeout for playNextVideo
        clearTimeout(nextVideoTimeout); 
        // When playVideo is executed, reset isSwitching.
        isSwitching = false; 
    }
    const videoPlayer = document.getElementById('videoPlayer');
    videoPlayer.addEventListener('play',function(){
        if (!isPosterSet) {
        videoPlayer.poster = "Other_Files/black.png";
        isPosterSet = true;
        }
    })
    // Automatically play next video after ending with a delay
    function playNextVideo() {
        if (!isSwitching) {
            isSwitching = true;
            // Delay before switching to the next video
            nextVideoTimeout = setTimeout(function() {
                if (clickCount % 2 === 1) {
                    newcurrentIndex = (newcurrentIndex + 1) % newvideoUrls.length;
                    videoPlayer.src = newvideoUrls[newcurrentIndex];
                } else {
                    currentIndex = (currentIndex + 1) % videoUrls.length;
                    videoPlayer.src = videoUrls[currentIndex];
                }
                videoPlayer.poster = "Other_Files/black.png"; // Clear the poster attribute
                videoPlayer.play();
                isSwitching = false;
            }, delay); // 2500 seconds delay (2.5 seconds)       
        }
    }

    // Add event listener to stop the timeout if playVideo is pressed while setTimeout is running
    videoPlayer.addEventListener('play', function() {
        clearTimeout(nextVideoTimeout);
    });

    const mediaQuery = window.matchMedia('(max-width: 722px)'); // Define a media query for mobile devices
    const moveableimg = document.querySelector('.moveable_img');
    const textToChange = document.getElementById('text_to_change');
    const navbarContent = document.getElementById('oldnavbarContent');
    const newnavbarContent = document.getElementById('newnavbarContent');
    const bodytext =document.getElementById('bodytext');
    const songname =document.getElementById('songname');
    const disablePreloadingbutton = document.querySelector('.subaru');
    const enablePreloadingbutton = document.querySelector('.trademark');
  

    moveableimg.addEventListener('click', function(){
        clickCount++;
        console.log("Image clicked!"); // Add this line for testing
        if (clickCount % 2 === 1) {
               textToChange.innerHTML = "All <s> OPs and EDs</s> Insert Songs";
            bodytext.innerHTML = "Insert Songs and more!"
            songname.innerHTML = "Openings and Endings"
            navbarContent.style.display = 'none';
            newnavbarContent.style.display ='block';
            videoPlayer.src="Insert_Songs/STRAIGHT BET.mp4";
            newcurrentIndex=0;
            clearTimeout(nextVideoTimeout);
            isSwitching = false; 
        }
        else {
            textToChange.innerHTML = "All OPs and EDs";
            bodytext.innerHTML = "Openings and Endings!";
            songname.innerHTML = "Insert Songs"
            navbarContent.style.display ='block';
            newnavbarContent.style.display ='none';
            videoPlayer.src="Openings_and_Endings/OP1 - Redo.mp4";
            currentIndex=0;
            clearTimeout(nextVideoTimeout); 
            isSwitching = false; 
        }
    });
    
    function handleFontSizeChange(mediaQuery) {
         // Change font size for mobile devices
        if (mediaQuery.matches) {
            textToChange.style.fontSize = '4.2vw';
        }
        // Reset font size for non-mobile devices
        else {
            textToChange.style.fontSize = 'inherit'; 
        }
    }

     // Initial call to set font size based on device width
    handleFontSizeChange(mediaQuery);
    // Add event listener for changes in media query
    mediaQuery.addEventListener('change', handleFontSizeChange);

    // Disable preloading when clicking on re:zero cast image
    disablePreloadingbutton.addEventListener('click',function(){
        if (!disablePreloading) {
            alert("Preloading disabled!");
            console.log('Preloading disabled!');
            disablePreloading = true;
             // Added failsafe if mistakenly clicked on picture (in IF statements: "!const" = "const === false")
            if (disablePreloading){
                enablePreloadingbutton.addEventListener('click',function(){
                    alert("Preloading enabled!");
                    console.log('Preloading enabled!');
                    disablePreloading = false;
                }, {once :  true});
            }
        }
    }, );

    // Video preloading 
    videoPlayer.addEventListener('timeupdate', function() {
        const currentTime = videoPlayer.currentTime;
        const duration = videoPlayer.duration;
        if (duration - currentTime <= 5 && !disablePreloading) {

        // Preload multiple videos based on the current video type
            if (clickCount % 2 === 1) {
            const nextNewIndex = (newcurrentIndex + 1) % newvideoUrls.length;
                if (!preloadedVideos.includes(newvideoUrls[nextNewIndex])) {
                    const nextNewVideo = new Audio(newvideoUrls[nextNewIndex]);
                    nextNewVideo.preload = 'auto';
                    preloadedVideos.push(newvideoUrls[nextNewIndex]);
                    console.log('Next new video preloaded:', newvideoUrls[nextNewIndex]);                                    
                }
            }
                else {
                    const nextIndex = (currentIndex + 1) % videoUrls.length;
                    if (!preloadedVideos.includes(videoUrls[nextIndex])) {
                        const nextVideo = new Audio(videoUrls[nextIndex]);
                        nextVideo.preload = 'auto';
                        preloadedVideos.push(videoUrls[nextIndex]);
                        console.log('Next video preloaded:', videoUrls[nextIndex]);       
                    }
                }
         }      
     });

     // Enable and Disable Looping functions
    enableLoopingListener = function EnableLooping() {
        if (clickCount % 2 == 1) {
        loopcurrentIndex = newcurrentIndex;
        videoPlayer.src = newvideoUrls[loopcurrentIndex];
        clearTimeout(nextVideoTimeout);
        }
        else {
        loopcurrentIndex = currentIndex;
        videoPlayer.src = videoUrls[loopcurrentIndex];
        clearTimeout(nextVideoTimeout);
        }
        videoPlayer.play();
        isSwitching = false;
    };
    const loopVideo = document.querySelector('.loop')
    const loopText = document.querySelector('.looptext')
    loopVideo.addEventListener('click',function() {
        loopclickCount++
            if (loopclickCount % 2 == 1){
                loopText.innerHTML = "Disable looping";
                videoPlayer.addEventListener('ended', enableLoopingListener);
                if (clickCount % 2 == 1)    
                    console.log('Video looping enabled for:', newvideoUrls[newcurrentIndex]);
                else
                    console.log('Video looping enabled for:', videoUrls[currentIndex]);   
            }
            else {
                loopText.innerHTML = "Enable looping";
                videoPlayer.removeEventListener('ended', enableLoopingListener);
                if (clickCount % 2 == 1)
                    console.log('Video looping disabled for:', newvideoUrls[newcurrentIndex])
                else 
                    console.log('Video looping disabled for:', videoUrls[currentIndex])
            }
    });

    // Function to shuffle the array elements randomly
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    return array;
    }
    // Get a reference to the shuffle button element
    const shuffleButton = document.getElementById('shuffleButton');
    // Add an event listener to the shuffle button to randomize the order of songs
    shuffleButton.addEventListener('click', function() {
    // Shuffle the videoUrls array
        if (clickCount % 2 == 1){
            newvideoUrls = shuffleArray(newvideoUrls);
            playVideo(newvideoUrls[0]);
            videoPlayer.pause();
        }
        else {
            videoUrls = shuffleArray(videoUrls);
            playVideo(videoUrls[0]);
            videoPlayer.pause();
        }
        alert("Videos shuffled! (check console logs for more info)");
    // You can now use the shuffled videoUrls array for playing the songs in a random order
        if (clickCount % 2 == 1)
            console.log('Shuffled videos to:', newvideoUrls);
        else
            console.log('Shuffled videos to:', videoUrls);
    });
    
    // Update the delay variable
    function updateDelay(newDelay) {
        delay = newDelay; 
    }
    // Add event listener for button click
    document.getElementById("changeDelayButton").addEventListener("click", function() {
        // Prompt user for new delay
        let newDelay = parseInt(prompt("Enter new delay in milliseconds (Current delay: " + delay + "ms)"));
        // Validate user input
        if (isNaN(newDelay) || newDelay < 0) {
            alert("Invalid delay. Please enter a non-negative number.");
        return;
        }
        // Update delay and optionally display confirmation
        updateDelay(newDelay);
        console.log("Delay updated to", newDelay, "milliseconds");
    });

   // Check for orientation change using matchMedia (for mobile devices)
    const checkOrientation = () => {
    if (window.matchMedia("(max-width: 722px) and (orientation: landscape)").matches) {
        alert("Please switch to portrait mode for the best experience.");
     }
    };
    // Listen for orientation changes
    window.addEventListener("resize", checkOrientation);

    // Register key being pressed
    document.addEventListener("keydown", function(event) {
        // Play/pause the video when pressing space
        if (event.code === "Space") {
            if (videoPlayer.paused)
                videoPlayer.play();
            else 
                videoPlayer.pause();
        }
        // Skipping to the next video using the playVideo function when pressing right arrow key
        if (event.code === "ArrowRight") {
            if (clickCount % 2 === 1) {
                const nextnewcurrentIndex = (newcurrentIndex + 1) % newvideoUrls.length;
                playVideo(newvideoUrls[nextnewcurrentIndex]);
            }
            else {
                const nextcurrentIndex = (currentIndex + 1) % videoUrls.length;
                playVideo(videoUrls[nextcurrentIndex]);
            }
        }
        // Returning to the previous video using the playVideo function (doesn't work if used on first video)
        if (event.code === "ArrowLeft") {
            if (clickCount % 2 === 1) {
                if (newcurrentIndex > 0) {
                    prevnewIndex = newcurrentIndex - 1;
                    playVideo(newvideoUrls[prevnewIndex]);
                }
            }   
            else {
                if (currentIndex > 0) {
                    prevIndex = currentIndex - 1;
                    playVideo(videoUrls[prevIndex]);
                }
            }
        }
    });
</script>
</body>
</html>
