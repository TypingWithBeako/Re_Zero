"mediaSession"in navigator||(navigator.mediaSession={setActionHandler:function(){},setPositionState:function(){},metadata:null}),"function"!=typeof MediaMetadata&&(window.MediaMetadata=function(e){this.title=e.title||"",this.artist=e.artist||"",this.album=e.album||"",this.artwork=e.artwork||[]});const nextVideo=document.createElement("video"),URL="https://rezero-en.7849684.xyz/";var videoUrls=[`${URL}OP1 - Redo.mp4`,`${URL}ED1 - STYX HELIX.mp4`,`${URL}OP2 - Paradisus - Paradoxum.mp4`,`${URL}ED2 - Stay Alive.webm`,`${URL}OP3 - Realize.mp4`,`${URL}ED3 - Memento.mp4`,`${URL}OP4 - Long shot.mp4`,`${URL}ED4 - Believe in you.webm`,`${URL}OP5 - Reweave.mp4`,`${URL}ED5 - NOX LUX.mp4`,],newvideoUrls=[`${URL}STRAIGHT BET.mp4`,`${URL}Bouya no Yume yo.mp4`,`${URL}Memories.mp4`,`${URL}White White Snow.mp4`,`${URL}Requiem of Silence.mp4`,`${URL}Wishing.mp4`,`${URL}Yuki no hate ni Kimi no na wo.mp4`,`${URL}Door.mp4`,`${URL}What you don't know.mp4`,`${URL}I Trust You.mp4`,];let isPosterSet=!1,currentIndex=0,newcurrentIndex=0;window.clickCount=0;let preloadedVideos=[],disablePreloading=!1,nextVideoTimeout,videoLoopingTimeout,loopclickCount=0,enableLoopingListener=null,delay=0,isAnimating=!1,FclickCount=0,nextClickCount=0,keyB=0,TheaterModeFlag=!1,TheaterModeClickCount=0,currentVolume=1,errorReloadTimeout,MASTER_SONGS=[];function playVideo(e){nextVideo.src="";let t=e.split("/").pop();document.getElementById("videoPlayer").src=e,document.getElementById("videoPlayer").play(),console.log("Video selected:",t),currentIndex=videoUrls.indexOf(e),newcurrentIndex=newvideoUrls.indexOf(e),isPosterSet||(videoPlayer.poster="Other_Files/black.png",isPosterSet=!0),clearTimeout(nextVideoTimeout),clearTimeout(videoLoopingTimeout),clearTimeout(errorReloadTimeout),simulateClick()}async function loadMasterSongs(){try{let e=await fetch("Assets/data/songsMetadata.json"),t=await e.json();return MASTER_SONGS=[...t.openings,...t.endings,...t.inserts,...t.specials,...t.concerts].sort((e,t)=>{let n={opening:1,ending:2,"insert song":3,special:4,"live concert":5};return n[e.type]!==n[t.type]?n[e.type]-n[t.type]:e.order-t.order}),console.log(`Media session loaded ${MASTER_SONGS.length} songs from metadata`),MASTER_SONGS}catch(n){return console.error("Failed to load metadata for media session:",n),[]}}function setMediaSessionMetadata(e){let t={"S1 Ending":"Season 1 Ending","S2 Ending":"Season 2 Ending","STYX HELIX slow":"STYX HELIX (slow ver.)","STYX HELIX nocut":"STYX HELIX (full ver.)"}[e]||e,n=MASTER_SONGS.find(n=>n.title===e||n.filename.includes(e)||n.title===t||cleanVideoSrcName(`${URL}${n.filename}`)===e);n?(navigator.mediaSession.metadata=new MediaMetadata({title:t,artist:n.artist,artwork:n.artwork?[n.artwork]:[]}),document.title="「"+t+"」"):(navigator.mediaSession.metadata=new MediaMetadata({title:t,artist:"Unknown Artist",artwork:[]}),document.title="「"+t+"」")}window.isEditingPlaylist=!1,document.addEventListener("DOMContentLoaded",async()=>{await loadMasterSongs(),console.log(`MASTER_SONGS ready with ${MASTER_SONGS.length} songs for media session`)});const videoPlayer=document.getElementById("videoPlayer");function toggleControls(){videoPlayer.hasAttribute("controls")?(videoPlayer.removeAttribute("controls"),showToast("Disabled video controls!")):(videoPlayer.setAttribute("controls",""),showToast("Enabled video controls!")),localStorage.setItem("controls",videoPlayer.hasAttribute("controls")?"true":"false")}function playNextVideo(){nextVideoTimeout=setTimeout(function(){clickCount%2==1?(newcurrentIndex=(newcurrentIndex+1)%newvideoUrls.length,videoPlayer.src=newvideoUrls[newcurrentIndex]):(currentIndex=(currentIndex+1)%videoUrls.length,videoPlayer.src=videoUrls[currentIndex]),videoPlayer.poster="Other_Files/black.png",videoPlayer.play()},delay)}videoPlayer.addEventListener("play",function(){clearTimeout(nextVideoTimeout),clearTimeout(videoLoopingTimeout),clearTimeout(errorReloadTimeout),isPosterSet||(videoPlayer.poster="Other_Files/black.png",isPosterSet=!0);let e=cleanVideoSrcName(videoPlayer.src);if("OP"==e.substr(0,2)||"ED"==e.substr(0,2)){let t=e.indexOf(" - ");e=e.substr(t+3)}setMediaSessionMetadata(e)}),navigator.mediaSession.setActionHandler("play",()=>{videoPlayer.play()}),navigator.mediaSession.setActionHandler("pause",()=>{videoPlayer.pause()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{previousVideoTrack()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{nextVideoTrack()}),videoPlayer.addEventListener("error",()=>{let e=cleanVideoSrcName(videoPlayer.src);clearTimeout(errorReloadTimeout),errorReloadTimeout=setTimeout(()=>{console.log("Attempting to reload:",e),videoPlayer.src=videoPlayer.src,videoPlayer.play().catch(e=>{console.error("Error when playing:",e,"Reloading in 7 seconds.")})},7e3)}),videoPlayer.addEventListener("play",function(){clearTimeout(nextVideoTimeout)});const mediaQuery=window.matchMedia("(max-width: 722px)"),moveableimg=document.querySelector(".moveable_img"),textToChange=document.getElementById("text_to_change"),navbarContent=document.getElementById("oldnavbarContent"),newnavbarContent=document.getElementById("newnavbarContent"),newInsertSongs=document.getElementById("newInsertSongs"),bodytext=document.getElementById("bodytext"),songname=document.getElementById("songname"),disablePreloadingbutton=document.querySelector(".subaru"),enablePreloadingbutton=document.querySelector(".trademark"),nextButton=document.getElementById("nextButton"),backButton=document.getElementById("backButton"),newnextButton=document.getElementById("newnextButton"),newbackButton=document.getElementById("newbackButton"),S3=document.getElementById("Season3Content"),SidebarButton=document.getElementById("SidebarButton"),Trademark=document.getElementById("trademark"),DelayButton=document.getElementById("Delay"),Openings=document.getElementById("Openings"),Endings=document.getElementById("Endings"),Insert_Songs=document.getElementById("Insert_Songs"),Openings_Content=document.getElementById("Openings_Content"),Endings_Content=document.getElementById("Endings_Content"),Insert_Songs_Content=document.getElementById("Insert_Songs_Content");function handleFontSizeChange(e){e.matches?textToChange.style.fontSize="4vw":textToChange.style.fontSize="inherit"}moveableimg.addEventListener("click",function(){!(isAnimating||this.hasAttribute("disabled"))&&(isAnimating=!0,this.setAttribute("disabled","disabled"),nextClickCount=0,++clickCount%2==1?(textToChange.innerHTML="All <s> OPs and EDs</s> Insert Songs",bodytext.innerHTML="Insert Songs!",songname.innerHTML="Openings and Endings",navbarContent.style.display="none",newnavbarContent.style.display="flex",videoPlayer.src=newvideoUrls[0],newcurrentIndex=0,currentIndex=-1,nextClickCount=0,clearTimeout(nextVideoTimeout),clearTimeout(videoLoopingTimeout),textToChange.classList.add("fade-in-title"),bodytext.classList.add("fade-in-bodytext"),songname.classList.add("fade-in-songname"),newnavbarContent.classList.add("slide-in"),moveableimg.classList.add("fade-in"),backButton.style.display="none",nextButton.style.display="none",newnextButton.style.display="inline",newbackButton.style.display="none",newnextButton.classList.add("fade-in-songname"),S3.style.display="none",Insert_Songs.style.display="",Endings.style.display="none",Openings.style.display="none",Openings_Content.style.display="none",Endings_Content.style.display="none",Insert_Songs_Content.style.display="",SidebarButton.innerHTML="Switch to OPs and EDs",console.log("- INSERT SONGS MODE - "),videoPlayer.addEventListener("loadeddata",()=>{isPosterSet&&(videoPlayer.currentTime=0)},{once:!0})):(textToChange.innerHTML="All OPs and EDs ",bodytext.innerHTML="Openings and Endings!",songname.innerHTML="Insert Songs",navbarContent.style.display="flex",newnavbarContent.style.display="none",newInsertSongs.style.display="none",videoPlayer.src=videoUrls[0],currentIndex=0,newcurrentIndex=-1,nextClickCount=0,clearTimeout(nextVideoTimeout),clearTimeout(videoLoopingTimeout),textToChange.classList.add("fade-in-title"),bodytext.classList.add("fade-in-bodytext"),songname.classList.add("fade-in-songname"),nextButton.classList.add("fade-in-songname"),navbarContent.classList.add("slide-in"),moveableimg.classList.add("fade-in"),nextButton.style.display="inline",newnextButton.style.display="none",newbackButton.style.display="none",Insert_Songs.style.display="none",Openings.style.display="",Endings.style.display="",Openings_Content.style.display="",Endings_Content.style.display="",Insert_Songs_Content.style.display="none",SidebarButton.innerHTML="Switch to Insert Songs",console.log("- OPENINGS AND ENDINGS MODE - "),videoPlayer.addEventListener("loadeddata",()=>{isPosterSet&&(videoPlayer.currentTime=0)},{once:!0})),setTimeout(()=>{isAnimating=!1,this.removeAttribute("disabled")},5751))}),textToChange.addEventListener("animationend",()=>{textToChange.classList.remove("fade-in-title")}),bodytext.addEventListener("animationend",()=>{bodytext.classList.remove("fade-in-bodytext")}),songname.addEventListener("animationend",()=>{songname.classList.remove("fade-in-songname")}),navbarContent.addEventListener("animationend",()=>{navbarContent.classList.remove("slide-in"),navbarContent.classList.remove("fade-in")}),newnavbarContent.addEventListener("animationend",()=>{newnavbarContent.classList.remove("slide-in"),newnavbarContent.classList.remove("fade-in")}),moveableimg.addEventListener("animationend",()=>{moveableimg.classList.remove("fade-in")}),S3.addEventListener("animationend",()=>{S3.classList.remove("fade-in")}),newInsertSongs.addEventListener("animationend",()=>{newInsertSongs.classList.remove("fade-in")}),backButton.addEventListener("animationend",()=>{backButton.classList.remove("fade-in")}),nextButton.addEventListener("animationend",()=>{nextButton.classList.remove("fade-in-songname"),nextButton.classList.remove("fade-in")}),newbackButton.addEventListener("animationend",()=>{newbackButton.classList.remove("fade-in")}),newnextButton.addEventListener("animationend",()=>{newnextButton.classList.remove("fade-in-songname"),newnextButton.classList.remove("fade-in")}),handleFontSizeChange(mediaQuery),mediaQuery.addEventListener("change",handleFontSizeChange);const root=document.documentElement;function disableFocus(e){e.addEventListener("mousedown",function(e){e.preventDefault()})}function ResetArray(){preloadedVideos=[]}function cleanVideoSrcName(e){let t=e.lastIndexOf("/")+1,n=e.lastIndexOf("."),i=e.substring(t,n);return i.replace(/%20/g," ")}disablePreloadingbutton.addEventListener("click",function(){disablePreloading||(showToast("Preloading disabled!","warning"),console.log("Preloading disabled!"),root.style.setProperty("--subarumouse","image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAllBMVEUAAAAkJCQfHx8SEhIMDAwNDQ0JCQkKCgoODg7x8fFycnL8/Pz9/f3Dw8MJCQn6+vqNjY3////y8vLp6ene3t7u7u7S0tLr6+vDw8P09PT29vb4+Pju7u7a2trw8PClpaVbW1ubm5utra0jKDP///8/Q03j5OWtrrNaXmbx8vLIycyRk5loa3MxNkCDhox2eYDx8fK6vL8DdzWRAAAAI3RSTlMABAcIDQsSFQ+YJePhKhrUOvCojG5nYVdUyMa0iYN3My0cGZgGfOIAAAD+SURBVDjLzZLZcsIwDEWxvJJAwtZC98WKk5LQ5f9/rso4Mx4UwjN61RndI9mzmypxvStAghDTEOzXOF/KSUTIMtS4eNUwQYDK/3xFyB0hFweo+Zf3vgm42JPLGAC1w8ZT/QR8WsYgFpHht/cDsult2ZLa5kcfq2qRFgJGaEMSQ0XbGJMk3D1JJOS4/hTMkiRSv6vx4zyEJMpB4tQGRHxWwC5BEqe+3/3iw8shMzoCI4kOy1VRWKOkGF+ipfSQvxfGaZmWSBKPJFHjyjqdHp5LVLgpXDzjGHAHbGiA0anNMrIccWsVTPRpxNt2Z5k9+xSGbccAkJJ/Fo70NbvB+gfwVhoJL6w+jwAAAABJRU5ErkJggg==) 1x, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAvVBMVEUAAAAdHR0TExMSEhIODg4KCgoHBwcGBgYHBwcJCQkMDAwGBgb+/v78/PwGBgYGBgbBwcH39/dra2vq6urExMT19fXu7u74+Pj09PTk5OTs7OzQ0NDm5ub+/v75+fn7+/vo6Oji4uLv7+/X19e1tbWysrKIiIjX19fa2trg4ODU1NRSUlKEhIS1tbW8vLwjKDP////j5OU/Q012eICtrrNaXmbx8fKfoaaRlJkxNkDIyczW19loa3ODhoxNUFlr0DWwAAAAL3RSTlMABgoIDQ8XEhUUERnx4yAbKsYnjFOmm7SXfWhiWeHU0p+Rd3JaRT1zS0k7Mh8YF+5vndUAAAIwSURBVFjD7ZbbUttAEERhtaurLcl2HDCXBJJA7tFYiMQBkv//rPRIU0FClFcrqige3O/d6jmz4/LeTju9UO1DT3F7P7573tgQ+PMZ0emRUsgY4/fyU2JNT5RCD/fvqyXcPwk6yDVP4lpAvyW6KzfEWuaug6AAB1wXRVkR6zDXLhEooMwh0aaAmojpO6cETBAfE90Uta7XdcSR5kGGB8xh+l00umoiTga34AD/TQ2hE3EgKIYFvCb6VfxXZyGDIIYCQdRaiFL2EvvKRAJB1F0IWtgqmKALobsQKwpACB5AeGQhW5+ijsNXRLf3zt5CkOAEobeQz0iwzDDDPRWiPs2JRoDLS+hG4NK/YJ1bZ2hB6OuW6JOyQpg8CqG8+1MxyG+DIFw9fAkVytdaxNshKEBYAEJ/hbUmq0hvbyAQ1u3uN413dvbxIgkDDQZOEP6u2X3+IU3TDH6jPEuADhKG0N4cnX2FO0v8KDCYYM92Dm0I5Rqfx9fhDtluPWpAiNsQKvgv0/rjMezit0FIAKFs+KP/cZr5mB323jXbIWCAJfyR2K1+OWl/RVRJgekl/LHuuC0U5SVIgfMswep4d0PlYQaBwAXm6K+76OwQ5Bx4he8TH/3Z7pCgTbjiH/cNCmR4u/369kVe1H8TuEBklHOApw1+llizJIydCzBGE4SLKU0Wc/hrgK4VOMGf4/W7+4WCMnEU4HgEgHMAYzBGaz3OjwBMwZL+4zpA/PzHi9077fRs+gdaMIOfVRGM4AAAAABJRU5ErkJggg==) 2x) 8 8, default"),Trademark.style.cursor="var(--pointermouse)",disablePreloading=!0,enablePreloadingbutton.addEventListener("click",function(){showToast("Preloading enabled!"),console.log("Preloading enabled!"),disablePreloading=!1,root.style.setProperty("--subarumouse","image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAmVBMVEUAAAAbGxsZGRkTExMICAgJCQkPDw8QEBB1YfIICAh0X/BwXeltWuFZSrdyXuxpV9xnVdZiU8tvXehyX+1wXehuXOZfT8VdUcE0LWxyX+1zX+1lU8xmU81hUchVSbJYTLdSR6P///91YfOGdfX39f6pnPfLxPvu6/3Y0/zCuvq6sPmxpviXiPaPfvV+a/R9a/TDuvqhkvegkvdrWLcYAAAAIXRSTlMABQcLEBQNCfEX45aKVcaOfye4lId2Tykk1LRycWFCQBntRKz0AAABCUlEQVQ4y83S11LDMBAF0KhLNm6k0tmVbCchBfj/j8MaGHmIZHhjuLNve7xWm/2vkF/azXze0Ok+Xesz6vX0FJVj359zNSlYfnJwyDibEIStcAs73HCmKEkBucFX2KLWt1ovWGwIE1kLPbatr3zZREKJmzdwCOALMXsmEbg+AnyBvsclJRGwAKFwwcjFGp7wHcbglfwOqCyt+xFw/QIAnQUA23nAaQrs0X+9T04oT26c4LCW9OIkH/VxXESHq2gX4h4PAdhMBBD+Ye6w/Wy7Fh84jc6amwpt58DtLFZCRoAwbooMfcrCcJW4ccWFKeqqLoxIvxtC2UCMb/ubSomBSCnDm0qjIbM/zgdM/h9ZMvytJwAAAABJRU5ErkJggg==) 1x, url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAsVBMVEUAAAAlJSUVFRUODg4KCgoICAgGBgYHBwcJCQkHBwd0YPIHBwcGBgYLCwtjU810X+9zX+9kU8xRQp5vXOdEOox0YPBzX+9wXelvXOZnVtdQRKc0LWpxXupyX+1rWd5tXORhUclWR7JkVMxORKJwXedwXupqWdtYSbZiVcv///91YfOGdfXu6/26sPn39f6onPfd1/x+a/TUzvuxpvipnffDuvqXiPbl4f3LxPuhkveypviacpDcAAAAKXRSTlMABQkMDxMWEBIY8RseFXLj00wZhzjiw5aof0Ylx8SeZmFXOTG4tmpXJ53eMHQAAAJ8SURBVFjD7ZfXdtswEEQTopAARXVbzXZc0jSUZFWX/P+HZQkgKocyQDMvOUnmAUcvczG7WEjQh//6a/XxN+1W9e0H1fVH3e/3UWQItfzdngb0oBvVIJjt2zBq1yGQPxoAyHMAPUaE9wdgGphPp3NAd+sQ2D2QT0k50GHROwlFgAcH2ACDmJXaEAZMNDAjwBq4FpwIVpUBXHwBdgRYAFomRCBZRlXACNi6JvSliBkrMfyAbOya8Aq0NK6/di41Lj85RhjAxASA7eKxeswhwiWolu3iDifqcGYJoQSJvALW9hgeF7PHX6u2hQQIBjAEXgjwbIIs3EoKTbdLEMseMCfAzLbCrU6dIoMfwLMRsHHWw+oKuWRBQJw1gW0J4ArR3EugDhHgFni1pvKKOBDBJXgyo5gfrw4gOPMmIMCDdoCyAGQ88gN4cgHks7cBMaNCfYAOTMPeAkhvE4pTHJozCAB8LWgDy6nVHPP9h+qAi0MFAPYfTgDeuxQAqMSfgAtTQv0EPBkAT2cBdpSDPUg6cBHKTVwC7cxMovc2fwZWz9Nz2gBDEfsnkXExaRHh7CjlwC2NsjcB1aD6rfPD/AJcqIQHb6NQfX2OMMuBpu1h6Fs1HRtC2d9S/ttMADMKMr2DJZz60d+PkTcCFyptAljt9vbFfAWgqdxlrkpAvl0uaPP1j8Kum6m0AQIA00iZ0lmcqD1OpeCRAYQJnAiN5hFCjxqF3waoREikShvfbq40mds3d41UycT5qxJEgXAiu4iN3wHChIjHSSaVUmlKixTF9tZfmcAoRSJEJoRIaHdW/m0PI4hhxDyvC++j+0h1nr1OUf3HPzFqmf+ov0//hn4CGZ+XfMz98P8AAAAASUVORK5CYII=) 2x) 10 6, pointer"),Trademark.style.cursor="var(--normalmouse)"},{once:!0}))}),videoPlayer.addEventListener("timeupdate",function(){let e=videoPlayer.currentTime,t=videoPlayer.duration;if(t-e<=5&&!disablePreloading){if(clickCount%2==1){let n=(newcurrentIndex+1)%newvideoUrls.length,i=cleanVideoSrcName(newvideoUrls[n]);preloadedVideos.includes(newvideoUrls[n])||(nextVideo.src=newvideoUrls[n],nextVideo.preload="auto",preloadedVideos.push(newvideoUrls[n]),console.log("Preloaded video:",i))}else{let o=(currentIndex+1)%videoUrls.length,a=cleanVideoSrcName(videoUrls[o]);preloadedVideos.includes(videoUrls[o])||(nextVideo.src=videoUrls[o],nextVideo.preload="auto",preloadedVideos.push(videoUrls[o]),console.log("Preloaded video:",a))}}}),disableFocus(videoPlayer),videoPlayer.addEventListener("ended",ResetArray),enableLoopingListener=function e(){clearTimeout(nextVideoTimeout),videoLoopingTimeout=setTimeout(()=>{videoPlayer.play()},delay)};const loopVideo=document.querySelector("#loop"),loopText=document.querySelector(".looptext");loopVideo.addEventListener("click",function(){loopclickCount++,loopVideo.classList.toggle("loop-active");let e=cleanVideoSrcName(videoPlayer.src);loopclickCount%2==1?(loopText.innerHTML="Disable looping",videoPlayer.ended&&enableLoopingListener(),videoPlayer.removeEventListener("ended",ResetArray),videoPlayer.addEventListener("ended",enableLoopingListener),console.log("Video looping enabled for: ",e),showToast("Video looping enabled for: "+e)):(loopText.innerHTML="Enable looping",videoPlayer.ended&&(clearTimeout(videoLoopingTimeout),playNextVideo()),videoPlayer.removeEventListener("ended",enableLoopingListener),videoPlayer.addEventListener("ended",ResetArray),console.log("Video looping disabled for: ",e),showToast("Video looping disabled for: "+e)),TheaterModeFlag&&setTimeout(Fullscreen,0)}),Fullscreen=function(){document.documentElement.requestFullscreen()};const checkOrientation=()=>{window.matchMedia("(max-width: 768px) and (orientation: landscape)").matches?(body.addEventListener("click",Fullscreen(),{once:!0}),body.removeEventListener("click",Fullscreen(),{once:!0}),setTimeout(function(){videoPlayer.style.width="auto",videoPlayer.style.height="100vh",videoPlayer.style.margin="0 auto"},700)):window.matchMedia("(max-width: 768px) and (orientation: portrait").matches?(videoPlayer.style.height="auto",videoPlayer.style.marginTop="6vw"):TheaterModeFlag||(videoPlayer.style.height="46.855vh",videoPlayer.style.marginTop="2vh")};function shuffleArray(e){for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}window.addEventListener("resize",checkOrientation);const shuffleButton=document.getElementById("randomize");function updateDelay(e){delay=1e3*e,localStorage.setItem("delay",delay.toFixed(3))}function nextVideoTrack(){if(clickCount%2==1){let e=(newcurrentIndex+1)%newvideoUrls.length;playVideo(newvideoUrls[e])}else{let t=(currentIndex+1)%videoUrls.length;playVideo(videoUrls[t])}}function previousVideoTrack(){if(clickCount%2==1)newcurrentIndex<0||(newcurrentIndex>0?prevnewIndex=newcurrentIndex-1:0==newcurrentIndex&&(prevnewIndex=newvideoUrls.length-1),playVideo(newvideoUrls[prevnewIndex]));else{if(currentIndex<0)return;currentIndex>0?prevIndex=currentIndex-1:0==currentIndex&&(prevIndex=videoUrls.length-1),playVideo(videoUrls[prevIndex])}}function handleNumberKeyPress(e){let t;if(e.startsWith("Numpad")&&7===e.length&&!isNaN(parseInt(e.charAt(6)))?t=parseInt(e.replace("Numpad","")):e.startsWith("Digit")&&6===e.length&&!isNaN(parseInt(e.charAt(5)))&&(t=parseInt(e.replace("Digit",""))),void 0===t||isNaN(t))return;let n=0===t?9:t-1;clickCount%2==1?n<newvideoUrls.length?playVideo(newvideoUrls[n]):showToast(`Video number ${t} doesn't exist (playlist have ${newvideoUrls.length} songs)`,"error"):n<videoUrls.length?playVideo(videoUrls[n]):showToast(`Video number ${t} doesn't exist (playlist have ${videoUrls.length} songs)`,"error")}function simulateClick(){let e=document.elementFromPoint(window.innerWidth-10,window.innerHeight-100);e&&e.click()}async function togglePictureInPicture(){if(document.pictureInPictureElement)await document.exitPictureInPicture();else try{await videoPlayer.requestPictureInPicture()}catch(e){showToast("Error entering Picture-in-Picture mode:","error")}}function openFullscreen(){videoPlayer.requestFullscreen?videoPlayer.requestFullscreen():videoPlayer.webkitRequestFullscreen?videoPlayer.webkitRequestFullscreen():videoPlayer.msRequestFullscreen&&videoPlayer.msRequestFullscreen()}function closeFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}shuffleButton.addEventListener("click",function(){clickCount%2==1?(playVideo((newvideoUrls=shuffleArray(newvideoUrls))[0]),preloadedVideos=[]):(playVideo((videoUrls=shuffleArray(videoUrls))[0]),preloadedVideos=[]),showToast("Videos shuffled!"),TheaterModeFlag&&setTimeout(Fullscreen,0),clickCount%2==1?console.log("Shuffled videos to:",newvideoUrls):console.log("Shuffled videos to:",videoUrls)}),document.getElementById("Delay").addEventListener("click",function(){let e=parseFloat(prompt("Enter new transition delay in seconds: (Current delay: "+delay/1e3+" seconds)"));if(TheaterModeFlag&&setTimeout(Fullscreen,0),isNaN(e)||e<0){showToast("Invalid delay. Please enter a non-negative number.","error");return}if(e>25){showToast("You really like to sleep when switching videos!","error");return}updateDelay(e),showToast(`Delay updated to ${e} seconds`)}),document.addEventListener("keydown",function(e){if(!isEditingPlaylist){if("Space"===e.code)videoPlayer.paused?videoPlayer.play():videoPlayer.pause();else if("ArrowRight"===e.code)nextVideoTrack();else if("ArrowLeft"===e.code)previousVideoTrack();else if(e.code.startsWith("Numpad")||e.code.startsWith("Digit"))handleNumberKeyPress(e.code);else if("Tab"===e.code)e.preventDefault(),togglePlaylist();else if("KeyQ"===e.code)shuffleButton.click();else if("KeyW"===e.code)loopVideo.click();else if("KeyE"===e.code)DelayButton.click();else if("KeyR"===e.code)togglePictureInPicture();else if("KeyF"===e.code)document.fullscreenElement&&document.fullscreenElement===videoPlayer||document.webkitFullscreenElement&&document.webkitFullscreenElement===videoPlayer||document.msFullscreenElement&&document.msFullscreenElement===videoPlayer?closeFullscreen():openFullscreen();else if("KeyC"===e.code)toggleControls();else if("KeyT"===e.code)TheaterMode.click();else if("KeyD"===e.code)playVideo(`${URL}Theater D.mp4`);else if("KeyO"===e.code)playVideo(`${URL}Season 1 Ending.webm`);else if("KeyP"===e.code)playVideo(`${URL}Season 2 Ending.mp4`);else if("KeyS"===e.code)playVideo(`${URL}ED1 - STYX HELIX slow.mp4`);else if("KeyB"===e.code)ChangeStyxHelix();else if("Escape"===e.code)TheaterModeFlag&&TheaterMode.click();else if("ArrowUp"===e.code){if(videoPlayer.muted){videoPlayer.muted=!1;return}if(currentVolume+.1>1){videoPlayer.volume=1,showVolumeToast(currentVolume=videoPlayer.volume);return}videoPlayer.volume=currentVolume+.1,showVolumeToast(currentVolume=videoPlayer.volume)}else if("ArrowDown"===e.code){if(videoPlayer.muted){videoPlayer.muted=!1;return}if(currentVolume-.1<1e-9){videoPlayer.volume=0,showVolumeToast(currentVolume=videoPlayer.volume);return}videoPlayer.volume=currentVolume-.1,showVolumeToast(currentVolume=videoPlayer.volume)}}}),nextButton.addEventListener("click",function(){!(isAnimating||this.hasAttribute("disabled"))&&(nextClickCount++,isAnimating=!0,this.setAttribute("disabled","disabled"),backButton.disabled=!0,navbarContent.style.display="none",S3.style.display="flex",nextButton.style.display="none",backButton.style.display="inline",S3.classList.add("fade-in"),backButton.classList.add("fade-in"),setTimeout(()=>{isAnimating=!1,this.removeAttribute("disabled"),backButton.disabled=!1},2501))}),backButton.addEventListener("click",function(){!(isAnimating||this.hasAttribute("disabled"))&&(nextClickCount--,isAnimating=!0,this.setAttribute("disabled","disabled"),nextButton.disabled=!0,navbarContent.style.display="flex",S3.style.display="none",nextButton.style.display="inline",backButton.style.display="none",navbarContent.classList.add("fade-in"),nextButton.classList.add("fade-in"),setTimeout(()=>{isAnimating=!1,this.removeAttribute("disabled"),nextButton.disabled=!1},2501))}),newnextButton.addEventListener("click",function(){!(isAnimating||this.hasAttribute("disabled"))&&(nextClickCount++,isAnimating=!0,this.setAttribute("disabled","disabled"),newbackButton.disabled=!0,newnavbarContent.style.display="none",newInsertSongs.style.display="flex",newnextButton.style.display="none",newbackButton.style.display="inline",newInsertSongs.classList.add("fade-in"),newbackButton.classList.add("fade-in"),setTimeout(()=>{isAnimating=!1,this.removeAttribute("disabled"),newbackButton.disabled=!1},2501))}),newbackButton.addEventListener("click",function(){!(isAnimating||this.hasAttribute("disabled"))&&(nextClickCount--,isAnimating=!0,this.setAttribute("disabled","disabled"),newnextButton.disabled=!0,newnavbarContent.style.display="flex",newInsertSongs.style.display="none",newnextButton.style.display="inline",newbackButton.style.display="none",newnavbarContent.classList.add("fade-in"),newnextButton.classList.add("fade-in"),setTimeout(()=>{isAnimating=!1,this.removeAttribute("disabled"),newnextButton.disabled=!1},2501))});const TheaterMode=document.getElementById("Theater"),ButtonContainer=document.getElementsByClassName("button-container"),paragraph=document.getElementById("paragraph"),body=document.getElementById("body"),ReZeroCast=document.getElementById("subaru"),GitHub=document.getElementById("github"),ExitTheaterModeButton=document.getElementById("ExitTheaterModeButton"),KeyboardControls=document.getElementById("KeyboardControls"),navbar=document.querySelector(".oldtopnav");function togglePlaylist(){moveableimg.click(),TheaterModeFlag&&(newnavbarContent.style.display="none",navbarContent.style.display="none")}function ExitTheaterMode(){TheaterMode.click()}TheaterMode.addEventListener("click",function(){if(++TheaterModeClickCount%2==1){navbarContent.style.display="none",nextButton.style.display="none",backButton.style.display="none",newnextButton.style.display="none",newbackButton.style.display="none",newnavbarContent.style.display="none",S3.style.display="none",newInsertSongs.style.display="none",paragraph.style.display="none",ReZeroCast.style.display="none",Trademark.style.display="none",GitHub.style.display="none",KeyboardControls.style.display="none",moveableimg.style.setProperty("display","none","important"),textToChange.style.display="none";for(let e=0;e<ButtonContainer.length;e++)ButtonContainer[e].style.display="none";videoPlayer.style.position="relative",videoPlayer.style.width="160vh",videoPlayer.style.height="90vh",videoPlayer.style.margin="5vh auto",body.style.backgroundColor="#000000",body.style.backgroundImage="none",document.documentElement.requestFullscreen(),document.pictureInPictureElement&&document.exitPictureInPicture(),TheaterModeFlag=!0,ExitTheaterModeButton.style.display="flex",navbar.style.marginTop="2vh"}else if(clickCount%2==1){1==nextClickCount?(newInsertSongs.style.display="flex",newnavbarContent.style.display="none",newnextButton.style.display="none",newbackButton.style.display="inline"):0==nextClickCount&&(newInsertSongs.style.display="none",newnavbarContent.style.display="flex",newnextButton.style.display="inline",newbackButton.style.display="none"),paragraph.style.display="block",ReZeroCast.style.display="block",Trademark.style.display="block",GitHub.style.display="block",KeyboardControls.style.display="flex",moveableimg.style.setProperty("display","inline","important"),textToChange.style.display="inline";for(let t=0;t<ButtonContainer.length;t++)ButtonContainer[t].style.display="block";body.style.backgroundImage="url(Other_Files/bg-tv.webp)",body.style.backgroundColor="#FFFFFF",videoPlayer.style.width="auto",videoPlayer.style.height="46.855vh",videoPlayer.style.margin="0 auto",videoPlayer.style.marginTop="2vh",ExitTheaterModeButton.style.display="none",TheaterModeFlag=!1,navbar.style.marginTop="3vh",closeFullscreen()}else{1==nextClickCount?(S3.style.display="flex",navbarContent.style.display="none",nextButton.style.display="none",backButton.style.display="inline"):0==nextClickCount&&(S3.style.display="none",navbarContent.style.display="flex",nextButton.style.display="inline",backButton.style.display="none"),paragraph.style.display="block",ReZeroCast.style.display="block",Trademark.style.display="block",GitHub.style.display="block",KeyboardControls.style.display="flex",moveableimg.style.setProperty("display","inline","important"),textToChange.style.display="inline";for(let n=0;n<ButtonContainer.length;n++)ButtonContainer[n].style.display="block";body.style.backgroundImage="url(Other_Files/bg-tv.webp)",body.style.backgroundColor="#FFFFFF",videoPlayer.style.width="auto",videoPlayer.style.height="46.855vh",videoPlayer.style.margin="0 auto",videoPlayer.style.marginTop="2vh",ExitTheaterModeButton.style.display="none",TheaterModeFlag=!1,navbar.style.marginTop="3vh",closeFullscreen()}}),document.addEventListener("DOMContentLoaded",function(){MicroModal.init({onShow:e=>console.info(`${e.id} is shown`),onClose:e=>console.info(`${e.id} is hidden`),openTrigger:"data-custom-open",closeTrigger:"data-custom-close",openClass:"is-open",disableScroll:!0,disableFocus:!0,awaitOpenAnimation:!0,awaitCloseAnimation:!0,debugMode:!1})});var button=document.querySelector("#KeyboardControls");button.addEventListener("click",function(){MicroModal.show("modal-1",{awaitCloseAnimation:!0})});const FULL=document.getElementById("STYX_HELIX_FULL"),FULL_sidebar=document.getElementById("STYX_HELIX_FULL_sidebar"),OG=document.getElementById("STYX_HELIX_OG"),OG_sidebar=document.getElementById("STYX_HELIX_OG_sidebar"),SeasonsEndings=document.getElementsByClassName("Endings--Seasons");function ChangeStyxHelix(){if(++keyB%2==1){-1!==(originalIndex=videoUrls.indexOf(`${URL}ED1 - STYX HELIX.mp4`))&&(videoUrls[originalIndex]=`${URL}ED1 - STYX HELIX nocut.mp4`),OG.style.display="none",OG_sidebar.style.display="none",FULL.style.display="inline",FULL_sidebar.style.display="flex";for(let e=0;e<SeasonsEndings.length;e++)SeasonsEndings[e].style.display="flex";showToast("Changed ED1 - STYX HELIX to full version!","info")}else{-1!==(originalIndex=videoUrls.indexOf(`${URL}ED1 - STYX HELIX nocut.mp4`))&&(videoUrls[originalIndex]=`${URL}ED1 - STYX HELIX.mp4`),OG.style.display="inline",OG_sidebar.style.display="flex",FULL.style.display="none",FULL_sidebar.style.display="none";for(let t=0;t<SeasonsEndings.length;t++)SeasonsEndings[t].style.display="none";showToast("Reverted changes to ED1 - STYX HELIX!","info")}TheaterModeFlag&&setTimeout(Fullscreen,0)}function isChrome136OrHigher(){let e=navigator.userAgent,t=e.match(/Chrome\/(\d+)/);if(!t)return!1;let n=parseInt(t[1],10);return n>=136}videoPlayer.addEventListener("volumechange",()=>{currentVolume=videoPlayer.volume,localStorage.setItem("volume",currentVolume.toFixed(2)),showVolumeToast(currentVolume)}),document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("volume"),t=localStorage.getItem("delay"),n=localStorage.getItem("controls");if(null!==e){let i=Number(parseFloat(e).toFixed(2));videoPlayer.volume=i,console.log("Setting saved volume:",100*i+"%")}if(null!==t){let o=Number(parseFloat(t).toFixed(3));delay=o,console.log("Setting saved delay:",delay/1e3+" seconds")}null!==n&&("false"===n&&videoPlayer.removeAttribute("controls"),console.log("Setting saved controls:","true"===n?"Visible":"Hidden"))}),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("service-worker.js").then(e=>{console.log("Registered Service Worker successfully with scope: ",e.scope)}).catch(e=>{console.log("Failed to register Service Worker: ",e)})}),document.addEventListener("visibilitychange",()=>{document.hidden||document.pictureInPictureElement||isChrome136OrHigher()||setTimeout(()=>{videoPlayer.currentTime=videoPlayer.currentTime},300)}),songname.addEventListener("click",function(){ChangeStyxHelix()});const standaloneMediaQuery=window.matchMedia("(display-mode: standalone)"),fullscreenMediaQuery=window.matchMedia("(display-mode: fullscreen)"),minimalUiMediaQuery=window.matchMedia("(display-mode: minimal-ui)");function isRunningAsInstalledPWA(){let e=standaloneMediaQuery.matches,t=fullscreenMediaQuery.matches,n=minimalUiMediaQuery.matches;return e||t||n}function handleDisplayModeChange(){videoPlayer.paused&&(isRunningAsInstalledPWA()?document.title="":document.title="Re:Zero All OPs and EDs")}function updatePlayCount(e){let t=JSON.parse(localStorage.getItem("songPlayCounts"))||{};t[e]=(t[e]||0)+1,localStorage.setItem("songPlayCounts",JSON.stringify(t)),console.log(`${e} is played ${t[e]} times.`)}standaloneMediaQuery.addEventListener("change",handleDisplayModeChange),fullscreenMediaQuery.addEventListener("change",handleDisplayModeChange),minimalUiMediaQuery.addEventListener("change",handleDisplayModeChange),handleDisplayModeChange(isRunningAsInstalledPWA()),videoPlayer.addEventListener("ended",()=>{updatePlayCount(cleanVideoSrcName(videoPlayer.src))});